# クライアントプロジェクトの初期化

Webアプリケーション実装の最初のステップは、Next.jsを使用した基本的な地図サイトの作成です。

## Next.jsプロジェクトの作成

まず、以下のコマンドを実行して、Next.jsプロジェクトを作成します。

```bash
npx create-next-app@latest
```

以下のとおりに質問に答えると、プロジェクトディレクトリが作成されます。
`No / Yes`の選択肢は、[ ]で囲まれた方を選択してください。

```
$ npx create-next-app@latest
Need to install the following packages:
create-next-app@14.2.15
Ok to proceed? (y) y

✔ What is your project named? … nahlun-tutorial
✔ Would you like to use TypeScript? … No / [Yes]
✔ Would you like to use ESLint? … [No] / Yes
✔ Would you like to use Tailwind CSS? … [No] / Yes
✔ Would you like to use `src/` directory? … No / [Yes]
✔ Would you like to use App Router? (recommended) … No / [Yes]
✔ Would you like to customize the default import alias (@/*)? … [No] / Yes
Creating a new Next.js app in /home/azishio/Project/nahlun-tutorial.

-- snip --
```

コマンドの終了後、作成されたディレクトリに移動します。
ディレクトリの構造は以下のようになっています。

```
.
├── node_modules
│   └── (snip)
├── src
│   └── app
│       ├── fonts
│       │   ├── GeistMonoVF.woff
│       │   └── GeistVF.woff
│       ├── favicon.ico
│       ├── globals.css
│       ├── layout.tsx
│       ├── page.module.css
│       └── page.tsx
├── README.md
├── next-env.d.ts
├── next.config.mjs
├── package-lock.json
├── package.json
└── tsconfig.json
```

## 不要な要素の削除

`/src/app`以下の`layout.tsx`と`page.tsx`以外のファイルを削除します。
最終的に、以下のファイルが残るようにします。

```
.
├── node_modules
│   └── (snip)
├── src
│   └── app
│       ├── layout.tsx
│       └── page.tsx
├── README.md
├── next-env.d.ts
├── next.config.mjs
├── package-lock.json
├── package.json
└── tsconfig.json
```

また、`layout.tsx`と`page.tsx`の内容を以下のように変更します。

`layout.tsx`:

```
import type { Metadata } from "next";

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body>
        {children}
      </body>
    </html>
  );
}

```

`page.tsx`:

```
export default function Home() {
  return <main>page</main>;
}
```

## 基本的な地図サイトの作成

準備したNext.jsに、地図を表示するためのコンポーネントを追加します。

### 依存関係の追加

以下のコマンドから、DECK.GLをインストールします。

```bash
npm install @deck.gl
```

### 地図コンポーネントの作成

`/src/app/`以下に、`App.tsx`を作成し、`page.tsx`から呼び出します。

`App.tsx`:

```
"use client";

import {DeckGL} from "@deck.gl/react";
import {BitmapLayer, TileLayer} from "deck.gl";

export function App() {

    const layer = new TileLayer({
        id: 'TileLayer',
        data: 'https://c.tile.openstreetmap.org/{z}/{x}/{y}.png',
        maxZoom: 19,
        minZoom: 0,

        renderSubLayers: props => {
            const {boundingBox} = props.tile;

            return new BitmapLayer(props, {
                data: null as unknown as undefined,
                image: props.data,
                bounds: [boundingBox[0][0], boundingBox[0][1], boundingBox[1][0], boundingBox[1][1]]
            });
        },
    });

    return (
        <DeckGL
            initialViewState={
                {
                    longitude: 139.0192649,
                    latitude: 36.486692,
                    zoom: 15
                }
            }
            controller
            layers={[layer]}
        >
        </DeckGL>
    );
}
```

`page.tsx`:

```
import {App} from "@/app/App";

export default function Home() {
    return (
        <main>
            <App/>
        </main>
    );
}
```

以上で、基本的な地図サイトの作成が完了しました。
`npm run dev`を実行して、ブラウザから確認すると、OpenStreetMapによる地図が表示されていることを確認できます。